define square{ box ht $1 wid $1 $2 }

#########################################
# Funcao S
# $1: Ponto inicial
# $2: Ponto final
# $3: Percentual da quebra [0.0 .. 1.0]
# $4: seta de inicio <- 
# $5: seta de fim    ->
define S
{
    line $4 from  $1 	       to ($3<$1,$2>, $1)
    line    from ($3<$1,$2>, $1) to ($3<$1,$2>, $2)
    line $5 from ($3<$1,$2>, $2) to  $2
}

#########################################
# Funcao N
# $1: Ponto inicial
# $2: Ponto final
# $3: Percentual da quebra [0.0 .. 1.0]
# $4: seta de inicio <- 
# $5: seta de fim    ->
define N
{  
    line $4 from  $1 	         to ($1, $3<$1,$2>)
    line    from ($1, $3<$1,$2>) to ($2, $3<$1,$2>)
    line $5 from ($2, $3<$1,$2>) to  $2
}

#########################################
# Funcao LV  - L a partir da vertical
# $1: Ponto inicial
# $2: Ponto final
# $3: seta de inicio <- 
# $4: seta de fim    ->
define LV
{  
    line $3 from  $1	 to ($1,$2)
    line $4 from ($1,$2) to  $2
}

#########################################
# Funcao LH - L a partir da horizontal
# $1: Ponto inicial
# $2: Ponto final
# $3: seta de inicio <- 
# $4: seta de fim    ->
define LH
{  
    line $3 from  $1	 to ($2,$1)
    line $4 from ($2,$1) to  $2
}

#########################################
# SUM : Bloco somador com 3 entradas e uma saida
# $1: "+" ou "-" entrada 'Oeste'
# $2: "+" ou "-" entrada 'Sul'
# $3: "+" ou "-" entrada 'Norte'
define SUM
{
CIRC:  	circle radius 5

	if $1 == "-" then 
	{"_" at 0.2<CIRC.w+(0,1),CIRC.e+(0,1)>}else{$1 at 0.2<CIRC.w,CIRC.e>}

	if $2 == "-" then
	{"_" at 0.3<CIRC.s,CIRC.n> }else{$2 at 0.2<CIRC.s,CIRC.n>}

	if $3 == "-" then
	{"_" at 0.9<CIRC.s,CIRC.n>}else{$3 at 0.8<CIRC.s,CIRC.n>}
	
	move to CIRC.e
}


